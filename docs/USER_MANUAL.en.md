# User Manual

Welcome to the user manual for the `xDuinoRails_MotorControl_bEMF` library. This document provides a comprehensive overview of the library's features and how to use them effectively.

## Introduction

The `xDuinoRails_MotorControl_bEMF` library is a Hardware Abstraction Layer (HAL) designed for low-level, high-performance motor control in the Arduino ecosystem. It provides a platform-agnostic API for controlling brushed DC motors with PWM and for measuring Back-EMF (BEMF) for sensorless feedback.

The key features of the library are:
- Hardware-accelerated PWM motor control.
- DMA-based ADC sampling for efficient BEMF measurement.
- A clean, consistent API across different microcontrollers.
- Real-time BEMF data delivery via a user-defined callback function.

## Core Concepts

Before using the library, it is important to understand a few core concepts:

### Hardware Abstraction Layer (HAL)

This library is a HAL, which means it provides a standardized interface to the underlying hardware. The actual implementation of the functions is specific to the microcontroller you are using (e.g., ESP32, RP2040, STM32). This allows you to write portable application code that is not tied to a specific hardware platform.

### Pulse-Width Modulation (PWM)

PWM is a technique used to control the power delivered to the motor, which in turn controls its speed. The library's `hal_motor_set_pwm()` function allows you to set the PWM duty cycle and the motor's direction.

### Back-EMF (BEMF)

BEMF is a voltage that is generated by a spinning motor. The magnitude of this voltage is proportional to the motor's speed. By measuring the BEMF, it is possible to determine the motor's speed without the need for a separate sensor (e.g., a rotary encoder). This is known as sensorless motor control.

### Direct Memory Access (DMA)

The library uses DMA to transfer ADC samples of the BEMF to a memory buffer without involving the CPU. This is highly efficient and allows for high-frequency sampling without impacting the performance of the main application.

## API Reference

For a detailed description of all the library's functions, please refer to the [Developer Reference](DEVELOPER_REFERENCE.en.md).

## Getting Started

To get started with the library, we recommend following the steps in the [How to Use](HOW_TO_USE.en.md) guide. You can also find practical examples in the `examples` directory of this project.

## Troubleshooting

- **Motor not moving:** Double-check your wiring and the pin definitions you are passing to `hal_motor_init()`. Ensure that the duty cycle is set to a non-zero value.
- **No BEMF data:** Verify that the BEMF pins are correctly connected to the motor terminals and that your callback function is correctly implemented and registered.
- **Compilation errors:** Make sure you have the correct PlatformIO environment selected for your target board, as this will determine which HAL implementation is used.
